/*
Use a case statement to sort through 3 Attributes more efficiently.
Pros:
  1) The O-runtime is more optimal because case statements with fewer evaluations are performed earlier.
Cons:
  1) The structure is deceptively simple because order matters significantly moreso than previously and is dependent on data points if it is a runtime upgrade.
     This version favors Attribute_1 over Attribute_2 and Attibute_2 over Attribute_3.
  2) Does this run accurately if there are non- 0 or 1 values present? Yes.
     Can this withstand NULLs? Yes.
Update: Traded simplicity of order for significantly faster O-runtime.
*/
SELECT
t1.primary_key
,CASE
  WHEN t1.Attribute_1 = 1 AND t1.Attribute_2 = 1 AND t1.Attribute_3 = 1 THEN 7
  WHEN t1.Attribute_1 = 1 AND t1.Attribute_2 = 1 THEN 6
  WHEN t1.Attribute_1 = 1 AND t1.Attribute_3 = 1 THEN 5
  WHEN t1.Attribute_1 = 1 THEN 1
  WHEN t1.Attribute_2 = 1 AND t1.Attribute_3 = 1 THEN 4
  WHEN t1.Attribute_2 = 1 THEN 2
  WHEN t1.Attribute_3 = 1 THEN 3
  ELSE 0
END AS Results
FROM Tables_skema.Table AS t1
WHERE Results <> 0
;
